<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml">
   
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      
      
      <meta name="copyright" content="(C) Copyright 2005" />
      
      <meta name="DC.rights.owner" content="(C) Copyright 2005" />
      
      <meta name="DC.Type" content="topic" />
      
      <meta name="DC.Title" content="Controlling data inputs with column constraints – AppSheet" />
      
      <meta name="DC.Relation" scheme="URI" content="211326838-Expressions_d126.html" />
      
      <meta name="DC.Relation" scheme="URI" content="http://206559378-Advanced-app-customizations.html" />
      
      <meta name="DC.Relation" scheme="URI" content="http://206435467.html" />
      
      <meta name="DC.Relation" scheme="URI" content="https://www.appsheet.com/template/AppDef?appName=RateCalculator-71626.html" />
      
      <meta name="DC.Relation" scheme="URI" content="https://www.appsheet.com/samples/An-app-to-add-and-update-sales-leads?appGuidString=2f43eb0a-1dbf-417f-9e2d-ccb8b9600d02.html" />
      
      <meta name="DC.Relation" scheme="URI" content="https://www.appsheet.com/template/showtable?allowExternalRedirect=false&amp;appName=DependentDropdowns-16350&amp;tableName=Regions.html" />
      
      <meta name="DC.Relation" scheme="URI" content="211326838-Expressions_d126.html" />
      
      <meta name="DC.Relation" scheme="URI" content="206435467-Multi-page-forms-with-conditional-branching_d211.html" />
      
      <meta name="DC.Relation" scheme="URI" content="205973178-App-formulas_d150.html" />
      
      <meta name="DC.Relation" scheme="URI" content="205113938-Defining-and-using-slices_d146.html" />
      
      <meta name="DC.Relation" scheme="URI" content="205856187-Column-types_d124.html" />
      
      <meta name="DC.Format" content="XHTML" />
      
      <meta name="DC.Identifier" content="CBBDDAABIDControllingDdataDinputsDwithDcolumnDconstraints" />
      
      <meta name="DC.Language" content="en-us" />
      
      <link rel="stylesheet" type="text/css" href="commonltr.css" />
      
      <link rel="stylesheet" type="text/css" href="epubStyles.css" />
      
      <title>Controlling data inputs with column constraints – AppSheet</title>
      
   </head>
   
   <body id="CBBDDAABIDControllingDdataDinputsDwithDcolumnDconstraints">
      
      
      
      <h1 class="title topictitle1">Controlling data inputs with column constraints –
         AppSheet
      </h1>
      
      <div class="body">
         
         <p class="p">Every column definition has a type (that specifies what
            values are allowed in the column) as well as flags that specify
            whether the column is hidden, whether it is required for input,
            etc. This is adequate for many apps, but sometimes a more
            dynamic or data-driven mechanism is needed. This is what Column
            Constraints provide-- a column constraint is an <a href="211326838-Expressions_d126.html" class="xref">expression</a> that is
            dynamically computed to determine the behavior of a specific
            column in an input form.
         </p>
         
         
         <p class="p">Four different column constraints can be defined for
            each column:
         </p>
         
         
         <ul class="ul">
            
            
            <li class="li">Show_If</li>
            
            
            
            <li class="li">Valid_If</li>
            
            
            
            <li class="li">Required_If</li>
            
            
            
            <li class="li">Editable_If</li>
            
            
            
         </ul>
         
         
         <p class="p">To add a column constraint, use the Column Structure tab of
            the Data pane in the <a href="http://206559378-Advanced-app-customizations.dita" class="xref">Advanced Editor</a> and click the "Edit"
            icon at the left of the corresponding column definition.
            
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <strong class="ph b">
               <span class="ph wysiwyg-font-size-large">Expression
                  components</span>
               </strong>
            
         </p>
         
         
         <p class="p">These expression components utilize the following
            formatting:
         </p>
         
         
         <ul class="ul">
            
            
            <li class="li">Name any column using square brackets around the exact
               column name: <strong class="ph b">[ColumnName]</strong>. When
               combining a [ColumnName] with another value, put the
               expression in (parentheses).
            </li>
            
            
            
         </ul>
         
         
         <ul class="ul">
            
            
            <li class="li">Use <strong class="ph b">[_THIS]</strong> as a
               "virtual column name." It refers to the value of the current
               column (used in Valid_If, Show_If, Required_If
               conditions).
            </li>
            
            
            
         </ul>
         
         
         <ul class="ul">
            
            
            <li class="li">Use <strong class="ph b">[_THISROW]</strong> as a
               "virtual reference column." It refers to the current row. For
               example, use [_THISROW].[ColumnName].
            </li>
            
            
            
         </ul>
         
         
         <ul class="ul">
            
            
            <li class="li">Highlight all values with "quotes," except for
               numeric values: <strong class="ph b">"Value"</strong>.
            </li>
            
            
            
         </ul>
         
         
         <ul class="ul">
            
            
            <li class="li">Numeric values are noted just as they are,
               e.g <strong class="ph b">10</strong>.
            </li>
            
            
            
         </ul>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Show_If</strong>
               </span>
            
         </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-medium">A Show_If column
               constraint is used when an input field should be
               shown or hidden depending on the values of one or more earlier
               field values in the form.</span>
            
         </p>
         
         
         <p class="p">A Show_If constraint is a condition expression that
            determines whether or not an input for this
            column should be shown in a form. This is usually based
            on the values of other columns. For example, the condition
            expression <em class="ph i">
               <strong class="ph b">[UserRating] =
                  "5"</strong> 
               </em>will display this column if the value
            in the "UserRating" column is "5". The condition
            expression <em class="ph i">
               <strong class="ph b">[Status] =
                  "Green" </strong>
               </em>will display this column if the
            value in the "Status" column is
            "Green"<em class="ph i">
               <strong class="ph b">.</strong>
               </em>
            
         </p>
         
         
         <p class="p">The special column name "_THIS" is used to refer to the
            current column being constrained. For example, a Show_If
            condition
            of <em class="ph i">
               <strong class="ph b">ISBLANK([_THIS])</strong>
               </em> can
            be used to show an input field only if the column itself
            is blank. The column will be hidden, once a data value has
            been entered and saved for the column. 
         </p>
         
         
         <p class="p">Show_If conditions can also be defined on Page Header
            columns to <a href="http://206435467.dita" class="xref">conditionally show or hide entire pages</a>.
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Valid_If</strong>
               </span>
            
         </p>
         
         
         <p class="p">Every input in a form is checked for validity based on its
            type. For example, a column of Number type will not accept
            "Hello" as an input. A Valid_If column constraint is used in
            situations where the validity of the input requires richer
            data-dependent logic.
         </p>
         
         
         <p class="p">A Valid_If constraint is a condition expression that
            determines whether or not the form input for this
            column is valid. For example, the <a href="https://www.appsheet.com/template/AppDef?appName=RateCalculator-71626.html" class="xref">
               Quote Calculator sample</a> utilizes a Valid_If condition
            to ensure that the Cost Per Hour must be less than
            $20.
         </p>
         
         
         <p class="p">Here are examples of commonly used Valid_If constraints:</p>
         
         
         <ol class="ol">
            
            
            <li class="li">Does the value of the column satisfy a simple condition?
               
               <ul class="ul">
                  
                  
                  <li class="li">For example, comparing the value with a
                     constant: <strong class="ph b">
                        <span class="ph wysiwyg-font-size-medium">
                           <em class="ph i">[_THIS] &gt;
                              5</em>
                           </span>
                        </strong>
                     
                  </li>
                  
                  
                  
                  <li class="li">For example, comparing the value with another column:
                     <em class="ph i">
                        <strong class="ph b">[_THIS] &gt; [ColumnA]</strong>
                        </em>
                     
                  </li>
                  
                  
                  
               </ul>
               
               
               
            </li>
            
            
            
            <li class="li">Is the value of the column in a list?
               
               <ul class="ul">
                  
                  
                  <li class="li">A list of constant values. For
                     example: <strong class="ph b">
                        <em class="ph i">{100, 200,
                           300}</em>
                        </strong>
                     
                  </li>
                  
                  
                  
                  <li class="li">A list of values from a column in another
                     table. For
                     example: <em class="ph i">
                        <strong class="ph b">LookupTable[ColumnC] </strong>. </em>This
                     is particularly useful if the list of allowed values
                     should itself be allowed to change while the app is being
                     used.
                  </li>
                  
                  
                  
                  <li class="li">A list of values from specific rows in another table.
                     For
                     example: <em class="ph i">
                        <strong class="ph b">SELECT(LookupTable[ColumnC],
                           [ReportDate] &gt; Today() -
                           7) </strong>
                        </em>specifies that the rows in
                     LookupTable should be filtered to find those where
                     ReportDate is within the last week, and the
                     corresponding values in ColumnC of LookupTable become the
                     allowed list of valid values.
                  </li>
                  
                  
                  
               </ul>
               
               
               
            </li>
            
            
            
         </ol>
         
         
         <p class="p">Whenever a list of allowed values is provided, it is
            actually a syntactic shortform for an expression that uses the
            IN function. For example, <strong class="ph b">
               <em class="ph i">{100, 200,
                  300} </em>
               </strong>is the same
            as <em class="ph i">
               <strong class="ph b">IN([_THIS], {100, 200,
                  300})</strong>. </em>In input forms in the mobile app,
            columns with such Valid_If constraints are provided with
            dropdowns or enumeration selectors that reflect the list of
            choices.
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Valid_If and
                  Dependent Dropdowns</strong>
               </span>
            
         </p>
         
         
         <p class="p">Dependent dropdowns are a common design pattern in apps that
            capture input. For example, consider an app like <a href="https://www.appsheet.com/samples/An-app-to-add-and-update-sales-leads?appGuidString=2f43eb0a-1dbf-417f-9e2d-ccb8b9600d02.html" class="xref">
               this Lead Tracker sample</a> that asks for the 'Lead Region'
            (America, Asia, Europe) and then for a 'Country' within that
            region. This is actually requires relatively complex
            logic, but AppSheet tries to make it simple. Dependent
            dropdowns are driven by a separate lookup table.
         </p>
         
         
         <p class="p">In the sample, there is a separate 'Regions' lookup table
            with two columns: 'Region' and 'Country'. This acts as the
            lookup table for allowed combinations of regions and countries.
            <a href="https://www.appsheet.com/template/showtable?allowExternalRedirect=false&amp;appName=DependentDropdowns-16350&amp;tableName=Regions.html" class="xref">
               Here is the table data</a> used in the sample.
         </p>
         
         
         <p class="p">The 'Lead Region' column has a regular Valid_If
            constraint: <strong class="ph b">
               <em class="ph i">Regions[Region]</em>
               </strong>.
            Therefore, when a new entry is being added, the input for this
            column shows three choices: America, Asia, and Europe.
         </p>
         
         
         <p class="p">Likewise, the 'Country' column also specifies a
            similar Valid_If constraint:
            <strong class="ph b">
               <em class="ph i">Regions[Country]</em>
               </strong>. However, because it
            follows the 'Lead Region' column and because both specify
            columns from the same lookup table 'Regions', AppSheet
            recognizes the intent and implements a dependent
            dropdown. 
         </p>
         
         
         <p class="p">Internally, AppSheet creates an expression to capture
            the allowed set of values for the 'Country' column. The
            expression must say (in English!):
         </p>
         
         
         <ul class="ul">
            
            
            <li class="li">Look at the Regions table</li>
            
            
            
            <li class="li">Filter the rows to make sure that the Region column of
               the table matches the value in the 'Lead Region' column of
               the row being edited in the form
            </li>
            
            
            
            <li class="li">Now extract the 'Country' column from those filtered
               rows
            </li>
            
            
            
            <li class="li">Eliminate any duplicates --- these are the allowed
               countries!
            </li>
            
            
            
            <li class="li">Recompute this list each time the 'Lead Region' is
               changed
            </li>
            
            
            
         </ul>
         
         
         <p class="p">Strictly for an expression afficionado, here is the full
            underlying AppSheet expression: <em class="ph i">
               <strong class="ph b">IN( [_THIS],
                  SELECT(Regions[Country], [_THISROW].[Lead Region] =
                  [Region]))</strong>
               </em>
            
         </p>
         
         
         <p class="p">While most app creators will never need to express something
            this complicated, you could infact provide this expression as a
            Valid_If constraint. It is useful to know for advanced use
            cases. For example, instead of using an equality condition, an
            app creator could use inequality or richer expressions to build
            very expressive dynamic dropdowns.
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Required_If </strong>
               </span>
            
         </p>
         
         
         <p class="p">A 'required' input is one that must be filled in
            before the record can be saved. A Required_If column
            constraint is used when a field is 'required'
            depending on the values of earlier form inputs.
         </p>
         
         
         <p class="p">A Required_If constraint is a condition expression that
            indicates whether a specific column is 'required' in an input
            form. It is usually based on the values of other columns
            (e.g. <em class="ph i">
               <strong class="ph b">[Country Of Birth]
                  = "USA"</strong>
               </em>).
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Editable_If </strong>
               </span>
            
         </p>
         
         
         <p class="p">When an input column is 'editable' it can be modified by the
            user. The Editable_If column constraint is useful to lock down
            a certain column (prevent user edits) depending on the value
            already in the column or on the values of other
            columns.
         </p>
         
         
         <p class="p">An Editable_If constraint is a condition expression that
            indicates whether a specific column is 'editable' in an input
            form (e.g. <em class="ph i">
               <strong class="ph b">ISBLANK([_THIS]</strong>
               </em>) allows
            edits if the current value is blank, but once there is a value,
            it cannot be edited). Another common use case is to give
            certain users the ability to edit a field but make it readonly
            for others (eg: <em class="ph i">
               <strong class="ph b">USEREMAIL()
                  = "manager@acme.com"</strong>
               </em>)
         </p>
         
         
         <p class="p"> </p>
         
         
         <p class="p">
            <span class="ph wysiwyg-font-size-large">
               <strong class="ph b">Best
                  practices</strong>
               </span>
            
         </p>
         
         
         <p class="p">Column constraints give you the power to define very
            subtle or complex conditions, but end-users will only see the
            resulting behavior. As an app creator, it is
            important to provide adequate explanations for the
            columns affected by these expressions--particularly for
            Valid_If conditions, so that users will know how to proceed if
            they provide an invalid column value. The best way to do so is
            by providing meaningful column descriptions.
         </p>
         
         
         <p class="p">When these expressions reference other fields in the
            row (not just [_THIS]), it is best to ensure that they are
            always "backward" references to fields that the end-user
            has already seen (meaning columns that come
            <em class="ph i">before</em> the column being considered in the spreadsheet
            and appear <em class="ph i">above</em> the column being considered in the
            Column Structure tab). Conditions containing "forward"
            references may be confusing to end-users and may cause
            problems with multi-page forms.
         </p>
         
         
         <div class="section">
            <h2 class="title sectiontitle">Related articles</h2>
            
            
         </div>
         
         
         <ul class="ul">
            
            
            <li class="li">
               
               <a href="211326838-Expressions_d126.html" class="xref">Expressions</a>
               
               
            </li>
            
            
            
            <li class="li">
               
               <a href="206435467-Multi-page-forms-with-conditional-branching_d211.html" class="xref">
                  Multi-page forms with conditional branching</a>
               
               
            </li>
            
            
            
            <li class="li">
               
               <a href="205973178-App-formulas_d150.html" class="xref">App formulas</a>
               
               
            </li>
            
            
            
            <li class="li">
               
               <a href="205113938-Defining-and-using-slices_d146.html" class="xref">Defining
                  and using slices</a>
               
               
            </li>
            
            
            
            <li class="li">
               
               <a href="205856187-Column-types_d124.html" class="xref">Column types</a>
               
               
            </li>
            
            
            
         </ul>
         
         
      </div>
      
      
      <div class="related-links">
         
         <div class="linklist linklist"><strong>Collected links</strong><br />
            
            
            <div><a href="211326838-Expressions_d126.html" class="link">expression</a></div>
            
            <div><a href="http://206559378-Advanced-app-customizations.dita" class="link">Advanced Editor</a></div>
            
            <div><a href="http://206435467.dita" class="link">conditionally show or hide entire pages</a></div>
            
            <div><a href="https://www.appsheet.com/template/AppDef?appName=RateCalculator-71626.html" class="link">
                  Quote Calculator sample</a></div>
            
            <div><a href="https://www.appsheet.com/samples/An-app-to-add-and-update-sales-leads?appGuidString=2f43eb0a-1dbf-417f-9e2d-ccb8b9600d02.html" class="link">
                  this Lead Tracker sample</a></div>
            
            <div><a href="https://www.appsheet.com/template/showtable?allowExternalRedirect=false&amp;appName=DependentDropdowns-16350&amp;tableName=Regions.html" class="link">
                  Here is the table data</a></div>
            
            <div><a href="211326838-Expressions_d126.html" class="link">Expressions</a></div>
            
            <div><a href="206435467-Multi-page-forms-with-conditional-branching_d211.html" class="link">
                  Multi-page forms with conditional branching</a></div>
            
            <div><a href="205973178-App-formulas_d150.html" class="link">App formulas</a></div>
            
            <div><a href="205113938-Defining-and-using-slices_d146.html" class="link">Defining
                  and using slices</a></div>
            
            <div><a href="205856187-Column-types_d124.html" class="link">Column types</a></div>
         </div>
         
      </div>
      
      
   </body>
   
</html>