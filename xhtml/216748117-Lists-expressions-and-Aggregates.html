<!DOCTYPE html>
<html dir="ltr" lang="en-US">
<head>
  <meta name="generator" content=   "HTML Tidy for HTML5 for Mac OS X version 5.1.25"/>
  <title>Lists expressions and Aggregates – AppSheet</title>
</head>
<body>
  <h1>Lists expressions and Aggregates – AppSheet</h1>
  <div class="content-body article-body">
    <p><span class="wysiwyg-color-black">Expressions may be used in
    various AppSheet features -- Initial Values, App Formulas,
    Virtual Columns and Column Constraints (Valid_If, Show_If,
    Required_If) -- to customize app behavior and provide your
    users with advanced functionality. Expressions in this article
    align with the <strong>Lists Expressions</strong> in
    the <strong>Expression Builder </strong>of
    the <strong>Advanced Editor</strong>. The
    Expression Builder can be found anywhere you are able to
    enter a formula/expression, noted by a little "flask"
    symbol next to it. Clicking on the flask will bring up the
    Expression Builder. The Expression Builder is "context-aware,"
    i.e. it shows you expressions that are relevant to the specific
    table you are editing. Also included in the builder is an
    "instant" expression checker, to verify that the expression is
    valid.</span></p>
    <p><span class="wysiwyg-color-black"> </span></p>
    <p><span class=
    "wysiwyg-color-black wysiwyg-font-size-large"><strong>Expression
    components</strong></span></p>
    <p><span class="wysiwyg-color-black">Use any of the following
    values as part of an expression:</span></p>
    <p><span class=
    "wysiwyg-color-black"><strong>Constants</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">Words, Dates, Times.
      Highlight all values with "quotes", except for
      numeric values,
      e.g. <strong>"Value"</strong>, <strong>"01/01/2016", "12:00:00"
      for time, "012:00:00" for duration.</strong></span></li>
      <li><span class="wysiwyg-color-black">Numeric values are
      noted just as they are,
      e.g <strong>10</strong>.</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"><strong>Column
    Names</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">Name any column using
      square brackets around the exact column
      name: <strong>[ColumnName]</strong>. When combining a
      [ColumnName] with another value, put the expression
      in <strong>(parentheses)</strong>. May be used in
      any expression; however, when used in the Initial Value
      feature, it may only refer to a separate table.</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"> </span></p>
    <p><span class=
    "wysiwyg-color-black wysiwyg-font-size-large"><strong>Lists
    conditions</strong></span></p>
    <p><span class="wysiwyg-color-black">Lists Expressions
    utilize operators that return a list or numeric
    value. AppSheet conditions are not a 1:1 match with
    Google Sheets functions; however, in some cases the formatting
    similarity may help you construct your expressions.
    Alternatively, if the formatting is not similar, the Google
    Sheets function page may provide context for use of the
    function. If available, see the Google Sheets function link in
    parentheses next to applicable operators.</span></p>
    <p><span class=
    "wysiwyg-color-black"><strong>Lists operators</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">LIST({*},{*})
       </span></li>
      <li><span class=
      "wysiwyg-color-black">SELECT({List}),{Yes/No}) </span></li>
      <li><span class="wysiwyg-color-black">COUNT({List})
       (<a href=
      "https://support.google.com/docs/answer/3093620?hl=en.html">COUNT</a>)</span></li>
      <li><span class="wysiwyg-color-black">SUM({List})
       (<a href=
      "https://support.google.com/docs/answer/3093669.html">SUM</a>)</span></li>
      <li>MIN({List})  (<a style="background-color: #ffffff;"
        href=
        "https://support.google.com/docs/answer/3094017.html">MIN</a>)
      </li>
      <li>MAX({List}) (<a style="background-color: #ffffff;"
        href=
        "https://support.google.com/docs/answer/3094013.html">MAX</a>)
      </li>
      <li>AVERAGE({List}) (<a style=
      "background-color: #ffffff;" href=
      "https://support.google.com/docs/answer/3093615.html">AVERAGE</a>)
      </li>
      <li><span class="wysiwyg-color-black">ANY({List})</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"> </span></p>
    <p><span class=
    "wysiwyg-color-black wysiwyg-font-size-large"><strong>Context</strong></span></p>
    <p><span class="wysiwyg-color-black">In addition to basic
    column types, we have a meta-type List_Of_X (eg: List Of
    Number, List Of Enum, etc) that represents a (potentially
    empty) list of unique values. This becomes really important for
    more powerful expressions.</span></p>
    <p><span class="wysiwyg-color-black">There are functions to
    construct lists and functions that use lists:</span></p>
    <p><span class="wysiwyg-color-black"><strong>Construct a
    list:</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">The simplest way to
      construct such a list is by explicitly writing it  {1,
      2, 3} or {[ColumnA], [ColumnB]}</span></li>
    </ul>
    <ul>
      <li><span class="wysiwyg-color-black">The
      <strong>LIST</strong> function is syntactically equivalent to
      an explicit list --- <strong>LIST</strong>(1,2,3) is the same
      as {1, 2, 3}</span></li>
    </ul>
    <ul>
      <li><span class="wysiwyg-color-black">A table column list âÄì
      the values are constructed from the unique values in a
      specific column of a specific table. Eg: Customers[Phone
      Number] returns a list of unique phone numbers in
      the Customers table</span></li>
    </ul>
    <ul>
      <li><span class="wysiwyg-color-black"><strong>SELECT</strong>
      is a more powerful way to construct a list from another
      table. It is  a stylized SQL select-from-where query.
      It returns a single list of values from one column of a
      table. However, a filter can be applied to eliminate some of
      the rows.  </span></li>
    </ul>
    <div style="margin-left: 2em">
      <ul>
        <li><span class="wysiwyg-color-black" style=
        "color: #ff00ff;"><span class=
        "wysiwyg-color-black">SELECT(Customers[Phone Number],
        [State] = âÄúWAâÄù)  --- returns a list of phone
        numbers of WA customers</span></span></li>
      </ul>
    </div>
    <p><span class="wysiwyg-color-black"> </span> </p>
    <p><span class="wysiwyg-color-black"><strong>Use a list
    (however it is constructed):</strong></span></p>
    <p><span class="wysiwyg-color-black">The most common use case
    is to check if a value is in a list:</span></p>
    <ul>
      <li><span class="wysiwyg-color-black">IN([ColumnName], {1, 2,
      3})</span></li>
      <li><span class="wysiwyg-color-black">IN([_THIS], {1, 2,
      3})  --- a special case used for column constraints
      like Valid_If and Show_If</span></li>
      <li><span class="wysiwyg-color-black">For column constraints,
      we accept a short form of the previous expression which is
      just the listâÄ¦ so {1, 2, 3} is treated as IN([_THIS], {1,
      2, 3})</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"> Aggregate
    functions</span></p>
    <ul>
      <li>/<strong>COUNT</strong>(&lt;list of
      anything&gt;)/</li>
      <li><strong>SUM</strong>(&lt;list of
        numeric type&gt;)</li>
      <li><strong>MIN</strong>(&lt;list of numeric type&gt;)</li>
      <li><strong>MAX</strong>(&lt;list of numeric type&gt;)</li>
      <li><strong>AVERAGE</strong>(&lt;list of numeric
        type&gt;)</li>
      <li><strong>ANY</strong>(&lt;list of
        anything&gt;) </li>
    </ul>
    <p class="wysiwyg-indent2"><span class=
    "wysiwyg-color-black">The behavior of COUNT(), SUM(), MIN(),
    MAX(), and AVERAGE() are self-evident. ANY() picks a single
    value from a list of values. For example, if there is a table
    called Customers, each of whom has a Name and a Phone Number,
    the expression ANY(SELECT(Customers[Phone], [Name] = "John
    Doe")) gets the phone number of a specific customer.</span></p>
    <p class="wysiwyg-indent2"><span class="wysiwyg-color-black">In
    many usage scenarios, a <strong>SELECT</strong> expression is
    used in the context of a particular column (eg: in a Valid_If
    or a Show_If ) in a particular row. In these contexts, the
    condition used in the <strong>SELECT</strong> function can
    utilize not just the columns of the table (Customer) but also
    the column values from the context in which it is used.
    <strong>[_THIS]</strong> refers to the cell/column from the
    context and <strong>[_THISROW]</strong> refers to the row from
    the context. See <a href=
    "211330018-Controlling-data-inputs-with-column-constraints.html">Column
    Constraints</a>.</span></p>
    <div style="margin-left: 2em">
      <ul>
        <li><span class="wysiwyg-color-black">A sample Valid_If
        condition for a column that accepts a State:  
        COUNT(SELECT(Customers[Phone Number], [State] = [_THIS]))
        > 100  --- this says the State is valid only if
        the number of customers in that state >
        100 </span></li>
        <li><span class="wysiwyg-color-black">A sample Show_If
        condition for a subsequent column in a form that first asks
        for a State: COUNT(SELECT(Customers[Phone Number], [State]
        = [_THISROW].[State])) > 1000  --- ask this
        question only for states with a lot of
        customers</span></li>
      </ul>
    </div>
    <p> </p>
    <p><span class=
    "wysiwyg-color-black wysiwyg-font-size-large"><strong>Common
    and complex expressions</strong></span></p>
    <p><span class="wysiwyg-color-black"><strong>Common
    expressions</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">Customers[Phone
      Number]: returns a list of unique phone numbers
      in the Customers table</span></li>
      <li><span class="wysiwyg-color-black">LIST(1,2,3): returns
      1,2,3</span></li>
      <li><span class="wysiwyg-color-black">SELECT(Customers[Phone
      Number], [State] = âÄúWAâÄù): returns a list of phone
      numbers of WA customers</span></li>
      <li><span class=
      "wysiwyg-color-black">COUNT({Dogs,Cats,Birds}): returns the
      number 3.</span></li>
      <li><span class="wysiwyg-color-black">COUNT({3,4,9,15,32}):
      returns the number 5.</span></li>
      <li><span class="wysiwyg-color-black">SUM({3,4,9,15,32}):
      returns the number 63.</span></li>
      <li><span class="wysiwyg-color-black">MIN({3,4,9,15,32}):
      returns the number 3.</span></li>
      <li><span class=
      "wysiwyg-color-black">MAX({3.1,4.2,9.3,15.4,32.5}): returns
      the number 32.5</span></li>
      <li><span class="wysiwyg-color-black">AVERAGE({1,2,3,4}):
      returns the number 2.5</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"><strong>Complex
    expressions</strong></span></p>
    <ul>
      <li><span class="wysiwyg-color-black">for Valid_If:
      COUNT(SELECT(Customers[Phone Number], [State] = [_THIS]))
      > 100:  the State is valid only if the number of
      customers in that state > 100</span></li>
      <li><span class="wysiwyg-color-black">for Show_If:
      COUNT(SELECT(Customers[Phone Number], [State] =
      [_THISROW].[State])) > 1000: ask this question only
      for states with a lot of customers</span></li>
    </ul>
    <p><span class="wysiwyg-color-black"> </span></p>
    <p><span class=
    "wysiwyg-color-black wysiwyg-font-size-large"><strong>Lists
    expression patterns and examples</strong></span></p>
    <p><span class="wysiwyg-color-black">From
    the <strong>Expression Builder,</strong> follow the
    pattern below for a list or numeric result. See examples for
    further clarity.</span></p>
    <table dir="ltr" border="1" >

      <tbody>
        <tr style="background-color: #b8d0f0;">
          <td data-sheets-value='[null,2,"Pattern"]'>
          <strong>Pattern</strong></td>
          <td data-sheets-value='[null,2,"Result"]'>
          <strong>Result</strong></td>
          <td data-sheets-value='[null,2,"Example"]'>
          <strong>Example</strong></td>
        </tr>
        <tr>
          <td data-sheets-value=
          '[null,2,"table_name[{column_name}]"]'><span class=
          "wysiwyg-color-black">table_name[{column_name}]</span></td>
          <td data-sheets-value='[null,2,"List"]'><span class=
          "wysiwyg-color-black">List</span></td>
          <td data-sheets-value='[null,2,"Field Types[Address]"]'>
          <span class="wysiwyg-color-black">Field
          Types[Address]</span></td>
        </tr>
        <tr>
          <td data-sheets-value='[null,2,"LIST({*},{*})"]'>
          LIST({*},{*})</td>
          <td data-sheets-value='[null,2,"List"]'>List</td>
          <td data-sheets-value=
          '[null,2,"LIST([ChangeTimestamp],\"value_1\")"]'>
          LIST([ChangeTimestamp],"value_1")</td>
        </tr>
        <tr>
          <td data-sheets-value=
          '[null,2,"SELECT({List},{Yes/No})"]'>
          SELECT({List},{Yes/No})</td>
          <td data-sheets-value='[null,2,"List"]'>List</td>
          <td data-sheets-value=
          '[null,2,"SELECT({\"value_1\", \"value_2\"},[Price] = 19.99)"]'>
          SELECT({"value_1", "value_2"},[Price] = 19.99)</td>
        </tr>
        <tr>
          <td data-sheets-value='[null,2,"COUNT({List})"]'>
          COUNT({List})</td>
          <td data-sheets-value='[null,2,"Number"]'>Number</td>
          <td data-sheets-value=
          '[null,2,"COUNT({\"value_1\", \"value_2\"})"]'>
          COUNT({"value_1", "value_2"})</td>
        </tr>
        <tr>
          <td data-sheets-value='[null,2,"SUM({List})"]'>
          SUM({List})</td>
          <td data-sheets-value='[null,2,"Number"]'>Number</td>
          <td data-sheets-value=
          '[null,2,"SUM({\"value_1\", \"value_2\"})"]'>
          SUM({"value_1", "value_2"})</td>
        </tr>
        <tr>
          <td data-sheets-value='[null,2,"SUM({List})"]'>
          ANY({List})</td>
          <td data-sheets-value='[null,2,"Number"]'>Number</td>
          <td data-sheets-value=
          '[null,2,"SUM({\"value_1\", \"value_2\"})"]'>
          ANY({"value_1", "value_2"})</td>
        </tr>
      </tbody>
    </table>
    <p> </p>
  </div>
  <div class="related-articles">
    <h2>Related articles</h2>
    <ul>
      <li>
        <a href="216188298-Other-expressions.html">Other
        expressions</a>
      </li>
      <li>
        <a href="211326838-Expressions.html">Expressions</a>
      </li>
      <li>
        <a href="216188178-Columns-expressions.html">Columns
        expressions</a>
      </li>
      <li>
        <a href=
        "211330018-Controlling-data-inputs-with-column-constraints.html">
        Controlling data inputs with column constraints</a>
      </li>
      <li>
        <a href="205856187-Column-types.html">Column types</a>
      </li>
    </ul>
  </div>
</body>
</html>
